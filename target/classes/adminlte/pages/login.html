<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>智能牧犬监控 | 登录</title>
    <!-- 告诉浏览器该页面是自适应布局 -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="../dist/css/font-awesome.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="../dist/css/ionicons.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="../dist/css/AdminLTE.min.css">
    <!-- iCheck -->
    <link rel="stylesheet" href="../dist/css/blue.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- 警告：Respond.js 不支持 file:// 方式查看（即本地方式查看）-->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- this page specific styles -->
    <link rel="stylesheet" href="ui_css/login.css" type="text/css" media="screen" />
    <!-- Google Font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
</head>
<body class="hold-transition login-page">
<div class="login-box" >
    <div class="login-logo">
        <a href="../../index2.html"><b>AI</b>智能牧犬监控</a>
    </div>
    <!-- /.login-logo -->
    <div class="login-box-body">
        <p class="login-box-msg">帐户登录</p>

        <form>
            <div class="form-group has-feedback">
                <input type="username" id="username" class="form-control" placeholder="用户名">
                <span class="glyphicon glyphicon-user form-control-feedback"></span>
            </div>
            <div class="form-group has-feedback">
                <input type="password" id="password" class="form-control" placeholder="密码">
                <span class="glyphicon glyphicon-lock form-control-feedback"></span>
            </div>
            <div class="row">
                <div class="col-xs-8">
                    <div class="checkbox icheck">
                        <label>
                            <input type="checkbox"> 记住我
                        </label>
                    </div>
                </div>
                <!-- /.col -->
                <div class="col-xs-4">
                    <button id="btnsubmit" type="button" class="btn btn-primary btn-block btn-flat">登录</button>
                </div>
                <!-- /.col -->
            </div>
        </form>

        <!-- /.social-auth-links -->

        <a href="#">忘记密码？</a><br>
        <a href="register.html" class="text-center">注册新会员</a>

    </div>
    <!-- /.login-box-body -->
</div>
<!-- /.login-box -->

<!-- jQuery 3 -->
<script src="../bootstrap/js/jquery-latest.js"></script>
<!-- Bootstrap 3.3.7 -->
<script src="../bootstrap/js/bootstrap.js"></script>
<!-- iCheck -->
<script src="../bootstrap/js/icheck.min.js"></script>
<script>
    $(function () {
        $('input').iCheck({
            checkboxClass: 'icheckbox_square-blue',
            radioClass: 'iradio_square-blue',
            increaseArea: '20%' /* optional */
        });

        $("#btnsubmit").click(function () {
            var usrn = document.getElementById("username").value.trim();
            var psw = document.getElementById("password").value.trim();
            var click_type = "login";
            var userinfo = {};
            userinfo.click_type = click_type;
            userinfo.username = usrn;
            userinfo.password = psw;
            $.ajax({
                url: timestamp("/aidog/page/sublogin"),
                type: "POST",
                async: false,
                data: userinfo,
                success: function (data) {
                    if (data == "" || data == null) {
                        alert("用户名或密码错误！");
                    } else {
//                        data = eval("("+data+")");
//                        if (data.status == "0") {
//                            alert("账户未激活！");
//                            return;
//                        }
//                        setCookie("watchdogusername", usrn, "s6000");
//                        if ($("#remember_me")[0].checked) {
//                            setCookie("rememberuser", usrn + "+" + psw, "s10000");
//                        } else {
//                            delCookie("rememberuser");
//                        }
                        window.location.href = "index_iframe.html?token="+data.data.token;
                        return true;
                    }
                }
            })
        });
    });

    function setCookie(name, value, time) {
        var strsec = getsec(time);
        var exp = new Date();
        exp.setTime(exp.getTime() + strsec * 1);
        document.cookie = name + "=" + escape(value) + ";expires=" + exp.toGMTString();
    }

    function timestamp(url) {
        var getTimestamp = new Date().getTime();
        if (url.indexOf("?") > -1) {
            url = url + "&timestamp=" + getTimestamp;
        } else {
            url = url + "?timestamp=" + getTimestamp;
        }
        return url;
    }
</script>
</body>
</html>
